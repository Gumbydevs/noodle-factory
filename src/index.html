<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Noodle Factory</title>
    <link rel="stylesheet" href="css/styles.css">
    <!-- Use this for local build:
    <script src="js/html2canvas.min.js"></script> -->
    <!-- Need to use this for online vercel version during testing: -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div id="preloader" class="preloader">
        <div class="loading-noodle"></div>
        <div class="loading-text">Loading Noodle Factory...</div>
        <div class="loading-progress"><div class="progress-bar"></div></div>
    </div>

    <div id="game-container" style="display: none;">
        <h1>The <span class="jiggly">Noodle</span> Factory <img src="assets/images/NoodleFactoryLogo.png" class="noodle-icon jiggly" alt="Noodle Factory Logo"></h1>
        
        <div id="stats">
            <div class="stat">
                <div class="stat-label">Prestige</div>
                <div id="prestige" class="stat-value prestige-color">0</div>
                <div class="stat-progress">
                    <div id="prestige-progress" class="stat-progress-fill prestige-color"></div>
                </div>
            </div>
            <div class="stat">
                <div class="stat-label">Chaos</div>
                <div id="chaos" class="stat-value chaos-color">0</div>
                <div class="stat-progress">
                    <div id="chaos-progress" class="stat-progress-fill chaos-color"></div>
                </div>
            </div>
            <div class="stat">
                <div class="stat-label">Ingredients</div>
                <div id="ingredients" class="stat-value ingredients-color">0</div>
                <div class="stat-progress">
                    <div id="ingredients-progress" class="stat-progress-fill ingredients-color"></div>
                </div>
                <div class="resources-row">
                    <span class="resource-item">
                        <span class="resource-icon">üí∞</span>
                        <span id="money-stat" class="resource-value money-color">$0</span>
                    </span>
                    <span class="resource-item">
                        <span class="resource-icon">üçú</span>
                        <span id="noodles-stat" class="resource-value noodles-color">0</span>
                    </span>
                </div>
            </div>
            <div class="stat">
                <div class="stat-label">Workers</div>
                <div id="energy" class="stat-value energy-color">100</div>
                <div class="stat-progress">
                    <div id="workers-progress" class="stat-progress-fill energy-color"></div>
                </div>
            </div>
            <div class="stat">
                <div class="stat-label">Day</div>
                <div id="turn" class="stat-value turn-color">1</div>
                <div class="stat-progress">
                    <div id="turn-progress" class="stat-progress-fill turn-color"></div>
                </div>
            </div>
        </div>

        <div id="factory-lights">
            <div class="lights-container">
                <!-- Light bulbs will be generated dynamically -->
            </div>
        </div>

        <div id="game-messages"></div>

        <div id="message-history-container">
            <div class="modal-overlay"></div>
            <div class="message-history-modal">
                <div class="message-history-header">
                    <h3 class="message-history-title">Message History</h3>
                    <button class="message-history-close">&times;</button>
                </div>
                <div class="message-history-content">
                    <!-- Messages will be inserted here dynamically -->
                </div>
            </div>
        </div>

        <div id="cards-container" class="hidden"></div>

        <div class="noodle-decoration">
            <svg class="noodle-worm" width="120" height="60" viewBox="0 0 180 60">
                <path class="noodle-body" 
                      d="M5,30 Q30,10 55,30 T105,30" 
                      stroke="#FFA500" 
                      stroke-width="6" 
                      stroke-linecap="round"
                      fill="none">
                    <animate attributeName="d" 
                             dur="1s"
                             repeatCount="indefinite"
                             values="M5,30 Q30,10 55,30 T105,30;
                                     M5,30 Q30,50 55,30 T105,30;
                                     M5,30 Q30,10 55,30 T105,30"/>
                </path>
                <path class="noodle-body-top" 
                      d="M5,30 Q30,10 55,30 T105,30" 
                      stroke="#FFD700" 
                      stroke-width="4" 
                      stroke-linecap="round"
                      fill="none">
                    <animate attributeName="d" 
                             dur="1s"
                             repeatCount="indefinite"
                             values="M5,30 Q30,10 55,30 T105,30;
                                     M5,30 Q30,50 55,30 T105,30;
                                     M5,30 Q30,10 55,30 T105,30"/>
                </path>
            </svg>
        </div>

        <div class="button-container">
            <button id="start-game" class="button primary">Start New Run</button>
            <!-- Continue button will be added dynamically when there's a save -->
            <button id="options-button" class="button secondary">Options</button>
        </div>
    </div>
    <script type="module" src="js/game.js"></script>

    <div class="message-history-modal">
        <div class="message-history-header">
            <h3 class="message-history-title">Factory Message Log</h3>
            <button class="message-history-close">&times;</button>
        </div>
        <div class="message-history-content">
            <!-- Message history will be populated here -->
        </div>
    </div>
    <div class="modal-overlay"></div>
</body>
</html>